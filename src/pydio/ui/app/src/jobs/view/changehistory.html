<div ng-controller="HistoryController as hc">
    <md-content ng-show="conflicts.length">
        <md-subheader class="section-title">{{_('Conflicts')}}</md-subheader>
        <div layout="row">
            <span flex></span>
            <md-checkbox ng-model="conflict_solver.applyToAll" ng-init="conflict_solver.applyToAll = false">{{_('Apply to all conflicts')}}</md-checkbox>
            <div style="width:17px;"></div>
        </div>
        <table style="width: 100%; padding-left:17px">
            <tr ng-show="conflict_solver.applyToAll">
                <td></td>
                <td></td>
            <td style="text-align:center">
                {{_('APPLY TO ALL')}}
            </td>
            </tr>
            <tr ng-show="conflict_solver.applyToAll">
                <td></td>
                <td></td>
                <td style="text-align:center">
                    <md-button class="md-raised" ng-click="solveConflict(conflict_solver.current.node_id, 'SOLVED:KEEPLOCAL');">{{_('Mine')}}</md-button>
                    <md-button class="md-raised" ng-click="solveConflict(conflict_solver.current.node_id, 'SOLVED:KEEPBOTH');">{{_('Both Versions')}}</md-button>
                    <md-button class="md-raised" ng-click="solveConflict(conflict_solver.current.node_id, 'SOLVED:KEEPREMOTE');">{{_('Theirs')}}</md-button>
                </td>
            </tr>
            <tr ng-repeat="conflict in conflicts">
                <td style="padding:2px 0;">{{conflict.node_path | basename}}</td>
                <td style="color: rgb(80,80,80); cursor:pointer" ng-click="openFile({'target':selected.directory+conflict.node_path}, $event)">{{selected.directory}}{{conflict.node_path}}</td>
                <td style="text-align:center">
                    <div ng-show="!conflict_solver.applyToAll">
                        <md-button class="md-raised" ng-click="solveConflict(conflict_solver.current.node_id, 'SOLVED:KEEPLOCAL');">{{_('Mine')}}</md-button>
                        <md-button class="md-raised" ng-click="solveConflict(conflict_solver.current.node_id, 'SOLVED:KEEPBOTH');">{{_('Both Versions')}}</md-button>
                        <md-button class="md-raised" ng-click="solveConflict(conflict_solver.current.node_id, 'SOLVED:KEEPREMOTE');">{{_('Theirs')}}</md-button>
                    </div>
                </td>

                <!--<td style="text-align: right;padding:2px 0;">
                    <md-button ng-show="conflict.status.indexOf('SOLVED:') === -1" ng-click="conflict_solver.current=conflict">{{_('Solve Conflict')}}</md-button>
                    <span ng-show="conflict.status.indexOf('SOLVED:') === 0" class="small">{{_('Solved')}}</span>
                </td>-->
            </tr>
        </table>
    </md-content>
    <md-content flex layout-padding ng-show="running.tasks && running.tasks.total != 0">
            <div ng-show="running.tasks && running.tasks.total">
            <span style="font-size: 1.2em;">{{_('Status')}}: {{_('syncing')}}</span>
            <br>{{_('Size')}}: {{running.global.queue_bytesize | bytes}} -
            {{_('Estimated time')}}: {{running.global.eta | seconds}}
            <!--{{_('Status')}}: {{_('syncing')}}-->
        </div>
        <md-list class="md-dense" flex>
            <md-subheader class="md-no-sticky" >
                <span ng-show="running.tasks.total === 0">{{_('Currently in Sync')}}</span>
                <span ng-show="running.tasks.total > 0" class="lead">{{_('Currently processing ')}}{{running.tasks.current.length}} {{_(' tasks (')}} {{selected.progress | number:0}}{{_('% completed)')}}</span>
            </md-subheader>
            <md-list-item class="md-2-line" ng-repeat="item in running.tasks.current">
                {{item}}
                <div class="md-list-item-text" layout="row">
                        <h3><i class="material-icons change-history-icon" ng-if="item.node.type === 'delete'">delete</i>
                        <md-icon class="change-history-icon" ng-if="item.node.type !== 'delete' && item.node.location == 'remote'">cloud_download</md-icon> <!--file_download-->
                        <md-icon class="change-history-icon" ng-if="item.node.type !== 'delete' && item.node.location == 'local'">cloud_upload</md-icon> <!--file_upload-->
                        </h3>
                        <h4>{{ item.node.node_path }}</h4>
                        <h4>{{item.node.bytesize }} - {{ item.node.bytes_sent }} -- {{ item.bytes_sent }} --- {{ item.node.total_bytes_sent }}</h4>
                        <md-progress-circular md-mode="determinate" md-diameter="20px" value="{{100*(item.node.bytesize/item.bytes_sent)}}"></md-progress-circular>
                </div>
                <!--<p>{{item}}</p>-->
            </md-list-item>
        </md-list>
    </md-content>

        <table ng-show="running.tasks.total > 0" class="table">

            <tr ng-show="running.tasks.total > 5">
                <td>{{running.tasks.total - 5}} more ... </td>
            </tr>
            </tbody>
        </table>


        <md-content flex>
            <md-list class="md-dense">
                <md-subheader class="md-no-sticky">{{_('Last synchronized files')}}</md-subheader>
                <div class="change-history-line" ng-repeat="item in logs" ng-if="item.type != 'sync'">
                    <span>
                        <i class="material-icons change-history-icon" ng-if="item.action == 'delete'">delete</i>
                        <i class="material-icons change-history-icon" ng-if="item.action !== 'delete' && item.type == 'remote'">cloud_upload</i> <!--file_upload-->
                        <i class="material-icons change-history-icon" ng-if="item.action !== 'delete' && item.type == 'local'">cloud_download</i> <!--file_download-->
                    </span>
                    <span class="change-history-text" ng-click="showChangeDetails(item, $event)">
                        {{ item.message }}
                    </span>
                    <md-icon class="md-secondary" ng-click="openFile(item, $event)">open_in_new</md-icon>
                </div>
            </md-list>
        </md-content>
    <!--
    {{ selected }}
    {{logs}}
    -->





<!--
<h4>Logs</h4>
<p class="lead">Previous operations</p>
<table class="table">
    <thead>
    <tr>
        <th></th>
        <th>Date</th>
        <th>Action</th>
        <th>File / Folder</th>
        <th>Status</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="log in logs">
        <td ng-if="log[1] == 'remote'"><span class="glyphicon glyphicon-cloud-upload"></span></td>
        <td ng-if="log[1] == 'local'"><span class="glyphicon glyphicon-cloud-download"></span></td>
        <td>{{log[7]}}</td>
        <td>{{log[5]}}</td>
        <td>{{log[4] && log[4]!=NULL ? log[4]:log[3]}}</td>
        <td>{{log[6] == 'undefined' ? 'OK' : log[6]}}</td>
    </tr>
    </tbody>
</table>
</div>
-->